<%= render :partial => 'tab_menu' %>


<div class="demande_tab_content" name="demande_tab_content">

<% old_statut_id, old_ingenieur_id = nil, nil %>
<table>
  <tr>
    <th>Date</th>
    <th>Changement(s)</th>
  </tr>

  <% idx = 0 %>
  <% @demande.versions.each_index do |i| %>
   <% demande = @demande.versions[i] %>
   <% next if old_statut_id == demande.statut_id and old_ingenieur_id == demande.ingenieur_id %>
    <tr class="<%= (idx % 2)==0 ? 'pair':'impair' %>">
     <td><%= demande.updated_on_formatted %></td>
     <td>
       <% if old_ingenieur_id != demande.ingenieur_id %>
         <% ingenieur = Ingenieur.find(demande.ingenieur_id) %>
         Le responsable de votre demande est <%= ingenieur.nom %><br />
       <% end %>
       <% if old_statut_id != demande.statut_id %>
         <% statut = Statut.find(demande.statut_id) %>
         Le statut de votre demande est <%= statut.nom %>
       <% end %>
     </td>
   </tr>
   <% idx = idx + 1 %>
  <% old_statut_id, old_ingenieur_id = demande.statut_id, demande.ingenieur_id %>
  <% end %>
</table>
</div>
