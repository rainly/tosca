<% cache("requests/#{@request_id || @request_tosca.id}/history") do %>
<div class="request_tab_content" name="request_tab_content">

<table>
  <tr>
    <th><%= _("Date") %></th>
    <th></th>
    <th><%= _("Change(s)") %></th>
  </tr>

  <% contract, rule = nil, nil %>
  <% @commentaires.each do |c| %>
     <% contract ||= c.request.contract %>
     <% rule ||= contract.rule %>
     <% history = display_history(c, rule, contract) %>
     <% unless history.nil? %>
      <tr class="<%= cycle('even', 'odd') %>">
        <td><%= c.created_on_formatted %></td>
        <td>&nbsp;</td>
        <td><%= history %></td>
      </tr>
     <% end %>
  <% end %>
</table>
</div>
<% end %>
